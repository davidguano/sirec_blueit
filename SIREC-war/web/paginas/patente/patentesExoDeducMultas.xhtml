<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:psirec="http://java.sun.com/jsf/composite/psirec">
    <!--EXONERACION DEDUCCION Y MUTLAS DE PATENTES-->
    <h:panelGrid>
        <center>
            <h:panelGrid id="pnlConExuDedMul" width="1000" columns="1" >
                <p:panel header="#{txt.lbl_header_Exo_Dec_Multas}">
                    <h:panelGrid columns="2">
                        <p:commandButton process="@this" action="#{gestionExoDedMulPatenteControlador.cargarNumPatente()}" value="Ver NÂ° Patente:" update=":frmPat:tabPrin:pnlConExoDedMulNumPat"/>
                        <p:panel>
                            <h:panelGrid columns="4" id="pnlConExoDedMulNumPat">
                                <p:outputLabel style="font-size: #{txt.font_size};" value="#{txt.lbl_num_patente}"/>
                                <p:inputText  disabled="true" id="numPatenteExoDedMul" value="#{gestionExoDedMulPatenteControlador.numPatente}"  
                                              size="40"/>
                                <p:message for="numPatenteExoDedMul"/>  
                                <psirec:panelInformativo  rendered="#{gestionExoDedMulPatenteControlador.numPatente==null}" id="infExoDedMulNumPat" background="#042B69" ancho="220" icono="fa-exclamation-triangle"
                                                          titulo="#{txt.lbl_head_error_patente}" tamanioTitulo="15" colorTitulo="white"
                                                          texto="#{txt.lbl_error_num_patente}" tamanioTexto="12" colorTexto="white"/>

                            </h:panelGrid>
                        </p:panel>
                    </h:panelGrid>
                    <h:panelGrid columns="3">

                        <h:outputLabel style="font-size: #{txt.font_size}" value="#{txt.lbl_adi_deductivo}"/>
                        <p:selectOneMenu   required="true" id="cmbAdiDeduc" 
                                           value="#{gestionExoDedMulPatenteControlador.adiDeductivoActual}" style="width:250px"
                                           converter="#{adicionalDeductivoConverter}" var="t">
                            <f:selectItem  itemLabel="Seleccione..." itemValue="" /> 
                            <f:selectItems var="tipTem"  
                                           value="#{gestionExoDedMulPatenteControlador.listAdicionalDeductivo}" 
                                           itemLabel="#{tipTem.adidedDescripcion}" 
                                           itemValue="#{tipTem}"/> 
                            <p:column width="200" style="white-space: normal">  
                                <h:outputText escape="false" value="#{t.adidedDescripcion}" style="font-size: 10px"/> 
                            </p:column> 
                        </p:selectOneMenu>   
                        <p:message for="cmbAdiDeduc"/>


                        <p:outputLabel  style="font-size: #{txt.font_size}" value="#{txt.lbl_mes_incumplimiento}"/>
                        <p:inputText  id="txtMesIncumplimiento"  value="#{gestionExoDedMulPatenteControlador.patValExActual.patvalextNumMesesIncum}" 
                                      maxlength="20" size="40"/>
                        <p:message for="txtMesIncumplimiento"/>

                        <h:outputLabel style="font-size: #{txt.font_size}" value="#{txt.lbl_notif_incumpliemento}"/>
                        <p:selectBooleanButton id="lblInNot" value="#{gestionExoDedMulPatenteControlador.patValExActual.patvalextObligado}" onLabel="Obligado" offLabel="No Obligado" style="width:80px" />
                        <p:message for="lblInNot"/>


                        <h:outputLabel style="font-size: #{txt.font_size}" value="#{txt.lbl_reduc_impuesto_mitad}"/>
                        <p:selectBooleanButton id="redImpMitad" value="#{gestionExoDedMulPatenteControlador.patValExActual.patvalextReduccionMitad}" onLabel="Si" offLabel="No" style="width:60px" />
                        <p:message for="redImpMitad"/>


                        <h:outputLabel style="font-size: #{txt.font_size}" value="#{txt.lbl_reduc_impuesto_tercera}"/>
                        <p:selectBooleanButton id="redImpTercera" value="#{gestionExoDedMulPatenteControlador.patValExActual.patvalextReduccion3eraparte}" onLabel="Si" offLabel="No" style="width:60px" />
                        <p:message for="redImpTercera"/>


                        <h:outputLabel style="font-size: #{txt.font_size}" value="#{txt.lbl_exo_artesano_calificado}"/>
                        <p:selectBooleanButton id="exoArtCal" value="#{gestionExoDedMulPatenteControlador.patValExActual.patvalextExonArtCalificado}" onLabel="Si" offLabel="No" style="width:60px" />
                        <p:message for="exoArtCal"/>

                        <h:outputLabel style="font-size: #{txt.font_size}" value="#{txt.lbl_patantes_sijetos_pago}"/>
                        <p:selectBooleanButton id="patPasivos" value="#{gestionExoDedMulPatenteControlador.patValExActual.patvalextIncumPlazoDecla}" onLabel="Si" offLabel="No" style="width:60px" />
                        <p:message for="patPasivos"/>


                        <p:outputLabel  style="font-size: #{txt.font_size}" value="#{txt.lbl_evacion_tribut}"/>
                        <p:selectOneMenu id="evaTRibutaria" value="#{gestionExoDedMulPatenteControlador.patValExActual.patenteEvasionTributaria}"  style="width:152px">
                            <f:selectItem itemLabel="Seleccione..." itemValue="" /> 
                            <f:selectItem itemLabel="1 Tributo" itemValue="#{1}" />
                            <f:selectItem itemLabel="2 Tributo" itemValue="#{2}1" />
                            <f:selectItem itemLabel="3 Tributo" itemValue="#{3}" />
                        </p:selectOneMenu>
                        <p:message for="evaTRibutaria"/>

                        <p:outputLabel  style="font-size: #{txt.font_size}" value="#{txt.lbl_porcentaje_ingreso}"/>
                        <p:inputText  id="porceIngreso"  value="#{gestionExoDedMulPatenteControlador.patValExActual.patentePorcIngreso}" 
                                      maxlength="20" size="40"/>
                        <p:message for="porceIngreso"/>

                        <p:outputLabel  style="font-size: #{txt.font_size}" value="#{txt.lbl_base_imponible_negativa}"/>
                        <p:inputText  id="baseImpNegativa"  value="#{gestionExoDedMulPatenteControlador.patValExActual.patenteBaseimpNegativa}" 
                                      maxlength="20" size="40"/>
                        <p:message for="baseImpNegativa"/> </h:panelGrid>  
                    <h:panelGrid columns="2">
                        <p:commandButton value="#{txt.btn_ver_documentos}" 
                                         id="btnVerDocu" 
                                         action="#{gestionExoDedMulPatenteControlador.activaPanerVerArchivos()}" 
                                         icon="ui-icon-disk"  
                                         process="@this,pnlConExuDedMul" 
                                         update=":frmPat,pnlConExuDedMul,frmPat:msgs"
                                         async="true"
                                         global="false"
                                         />
                        <p:commandButton value="#{txt.btn_cargar_documentos}" 
                                         id="btnCargaDocu" 
                                         action="#{gestionExoDedMulPatenteControlador.activPanelCargrArchivos()}" 
                                         icon="ui-icon-disk"  
                                         process="@this,pnlConExuDedMul" 
                                         update=":frmPat,pnlConExuDedMul,frmPat:msgs"
                                         async="true"
                                         global="false"
                                         />
                    </h:panelGrid>                   
                </p:panel>
                <h:panelGrid id="pnlConCargarFile">
                    <p:panel header="Archivo" style="font-size: #{txt.font_size}" rendered="#{gestionExoDedMulPatenteControlador.cargarArchivos==1}">
                        <h:panelGrid>
                            <p:panel header="Adjuntar Documentos" style="font-size: #{txt.font_size}">
                                <h:panelGrid columns="3">
                                    <h:panelGrid width="150">
                                        <p:graphicImage value="/imagenes/subir.png" height="40px" width="40px"/>
                                        <h:outputText value="Recuerde:" style="color: firebrick;font-size: 10px;font-weight: bold" ></h:outputText>
                                        <h:outputText value="El archivo debe ser: *.pdf,excel,jpg(max 750 px)" style="color: #666;font-size: 10px;font-weight: bold" ></h:outputText>
                                    </h:panelGrid>
                                    <p:fileUpload fileUploadListener="#{gestionExoDedMulPatenteControlador.handleFileUpload}"  
                                                  mode="advanced"
                                                  dragDropSupport="false"
                                                  multiple="true"  
                                                  update=":frmPat:msgs,:frmPat:tabPrin:infoExoDedMul"
                                                  sizeLimit="1000000"
                                                  allowTypes="/(\.|\/)(pdf|xls|xlsx|jpg)$/"
                                                  invalidSizeMessage="El archivo debe ser maximo 1MB"
                                                  label="Seleccione el archivo" 
                                                  uploadLabel="Cargar"
                                                  cancelLabel="Cancelar"
                                                  process="@this,infoExoDedMul"  >                                                                                             
                                        <f:attribute name="tipoArchivo" value="CapacitaciÃ³n teÃ³rica" />
                                    </p:fileUpload>  
                                    <h:panelGroup id="infoExoDedMul">
                                        <p:panel rendered="#{gestionExoDedMulPatenteControlador.listaFiles.size()>0}">
                                            <f:facet name="header">
                                                <h:outputText value="Archivos:" />
                                            </f:facet>
                                            <p:dataGrid  columns="1" value="#{gestionExoDedMulPatenteControlador.listaFiles}"  var="file" >
                                                <p:panel>
                                                    <h:panelGrid columns="2">
                                                        <h:panelGrid columns="4">
                                                            <h:outputText value="Achivo:" />
                                                            <h:outputText value="#{file.name}" />  
                                                            <h:outputText value=" " />
                                                            <p:column headerText="#{txt.lbl_eliminar}" style="width:50px;text-align: center;font-size:12px;" >
                                                                <p:commandButton style="font-size:12px;" icon="ui-icon-trash"  
                                                                                 actionListener="#{gestionExoDedMulPatenteControlador.confirmaEliminarArchivo(file)}" 
                                                                                 process="@this" async="true" global="false" update=":frmPat:tabPrin:infoExoDedMul,:frmPat:msgs"  >
                                                                    <p:confirm header="ConfirmaciÃ³n" message="Â¿EstÃ¡ seguro de eliminar el registro?" icon="ui-icon-alert" />
                                                                </p:commandButton>
                                                            </p:column>  
                                                        </h:panelGrid>
                                                    </h:panelGrid>
                                                </p:panel>
                                            </p:dataGrid>
                                        </p:panel>
                                    </h:panelGroup>
                                </h:panelGrid> 
                                <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                                    <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                    <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                </p:confirmDialog>


                            </p:panel>
                            <h:panelGrid id="tblListArchvosExoDedmul">
                                <p:panel style="width: 750px" header="Archivos Cargados" rendered="#{gestionPatenteControlador.listadoArchivos.size()>0}">
                                    <p:dataTable    paginator="true" rows="5" id="tablLisExoDedMul" value="#{gestionPatenteControlador.listadoArchivos}"  var="archivoColumna"   
                                                    selectionMode="single" rowKey="#{archivoColumna.patarcCodigo}"
                                                    styleClass="pdataTable_font"
                                                    currentPageReportTemplate="{currentPage} de {totalPages}">                              
                                        <p:column   headerText="Nombre Archivo" width="100" style="font-size:12px;">
                                            <h:outputText value="#{archivoColumna.patarcNombre}" style="font-size:12px;" />
                                        </p:column> 

                                        <p:column headerText="#{txt.eliminar_btn}" style="width:50px;text-align: center;font-size:12px;" >
                                            <p:commandButton style="font-size:12px;" icon="ui-icon-trash"  
                                                             actionListener="#{gestionPatenteControlador.confirmaEliminarPatArchivo(archivoColumna)}" 
                                                             process="@this" update=":frmPat:tabPrin:tablLisExoDedMul,:frmPat:tabPrin:tablLisExoDedMul:message" async="true" global="false">
                                                <p:confirm header="ConfirmaciÃ³n" message="Â¿EstÃ¡ seguro de eliminar el registro?" icon="ui-icon-alert" />
                                            </p:commandButton>
                                        </p:column>  
                                    </p:dataTable>     
                                </p:panel>
                            </h:panelGrid>
                        </h:panelGrid>
                    </p:panel>
                    <p:panel>
                        <h:panelGrid id="tblLisArchCargados" rendered="#{gestionExoDedMulPatenteControlador.verArchivos==1}">
                                    <p:panel style="width: 750px" header="Archivos Cargados" rendered="#{gestionExoDedMulPatenteControlador.listadoArchivos.size()>0}">
                                        <p:dataTable    paginator="true" rows="5" id="tablaListaPatArchivos" value="#{gestionExoDedMulPatenteControlador.listadoArchivos}"  var="archivoColumna"   
                                                        selectionMode="single" rowKey="#{archivoColumna.patarcCodigo}"
                                                        styleClass="pdataTable_font"
                                                        currentPageReportTemplate="{currentPage} de {totalPages}">                              
                                            <p:column   headerText="Nombre Archivo" width="100" style="font-size:12px;">
                                                <h:outputText value="#{archivoColumna.patarcNombre}" style="font-size:12px;" />
                                            </p:column> 
                                            <p:column   headerText="Tipo" width="100" style="font-size:12px;">
                                                <h:outputText value="PATENTE" rendered="#{archivoColumna.patarcTipo=='PA'}" style="font-size:12px;" />
                                                <h:outputText value="EXONERACIÃN" rendered="#{archivoColumna.patarcTipo=='EX'}" style="font-size:12px;" />
                                                <h:outputText value="RECARGO" rendered="#{archivoColumna.patarcTipo=='RE'}" style="font-size:12px;" />
                                                <h:outputText value="DEDUCCIÃN" rendered="#{archivoColumna.patarcTipo=='DE'}" style="font-size:12px;" />
                                                <h:outputText value="TABLA" rendered="#{archivoColumna.patarcTipo=='TA'}" style="font-size:12px;" />
                                            </p:column> 
                                            
                                        </p:dataTable>     
                                    </p:panel>
                                </h:panelGrid>
                    </p:panel>
                        
                </h:panelGrid>
                <h:panelGrid columns="2">
                    <p:commandButton value="#{txt.btn_guardar}" 
                                     id="btnGuardar2" 
                                     action="#{gestionExoDedMulPatenteControlador.guardaPatenteValExtra()}" 
                                     icon="ui-icon-disk"  
                                     process="@this,pnlConExuDedMul" 
                                     update=":frmPat,pnlConExuDedMul,frmPat:msgs"
                                     async="true"
                                     global="false"
                                     />
                </h:panelGrid>
            </h:panelGrid>                      
        </center>
    </h:panelGrid>

</html>
